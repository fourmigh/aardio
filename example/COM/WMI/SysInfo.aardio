//WMI è·å–ç³»ç»Ÿä¿¡æ¯
//ğŸ“ com.wmi åº“æ–‡æ¡£: doc://library-reference/com/wmi.md
//ğŸ’» WMI æŸ¥è¯¢å…¥é—¨](doc://example/COM/WMI/query.aardio
//ç›¸å…³èŒƒä¾‹: èŒƒä¾‹\æ“ä½œç³»ç»Ÿ\ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯;èŒƒä¾‹\æ“ä½œç³»ç»Ÿ\ç¡¬ä»¶ä¿¡æ¯\æŸ¥è¯¢ç¡¬ä»¶ä¿¡æ¯  

import com.wmi;
var osInfo = com.wmi.get("os");
print(osInfo.Caption());//æ“ä½œç³»ç»Ÿ
print(osInfo.Version());//ç‰ˆæœ¬

//è·å–æ“ä½œç³»ç»Ÿå®‰è£…æ—¶é—´
var installDate = com.wmi.get("os","installDate") 
print("Windows æ“ä½œç³»ç»Ÿå®‰è£…æ—¶é—´:", installDate.format("%Yå¹´%mæœˆ%dæ—¥ %Hæ—¶%Måˆ†%Sç§’") );

import sys.cpu;
var cpu = sys.cpu.getInfoByWmi()
print(cpu.DeviceID);//CPU
print(cpu.Name);//
print("CPU æ ¸å¿ƒæ•°ï¼š",cpu.NumberOfCores);
print("CPU é€»è¾‘æ ¸å¿ƒæ•°ï¼š", cpu.NumberOfLogicalProcessors);
print("CPU æœ€å¤§é€Ÿåº¦ï¼š", math.round(cpu.MaxClockSpeed/1000,2) + "GHz");
print("CPU å½“å‰é€Ÿåº¦ï¼š", math.round(cpu.CurrentClockSpeed/1000,2) + "GHz");
print("CPU ä½å®½ï¼š" ,cpu.AddressWidth);

/*
import sys.tpmInfo;
var tpmInfo = sys.tpmInfo.get();
 
if(tpmInfo){
	print("æ”¯æŒ TPM");
	print("TPM æ˜¯å¦å¯ç”¨ï¼š",tpmInfo.enabled);
	print("TPM æ˜¯å¦æ¿€æ´»ï¼š",tpmInfo.activated);
	print("TPM æ”¯æŒç‰ˆæœ¬ï¼š",tpmInfo.version)
}
else {
	print("ä¸æ”¯æŒ TPM");
}
*/

for index,mem in com.wmi.each("win32_physicalmemory") {
	print("å†…å­˜å®¹é‡",..math.size64(mem.capacity()).format());
} 

for cfgAdapter,index in com.wmi.eachProperties(
	"SELECT * FROM Win32_NetworkAdapterConfiguration WHERE IPEnabled=true"){
    	print(cfgAdapter.Description);//ç½‘å¡
    	print(cfgAdapter.DefaultIPGateway[1]);//é»˜è®¤ç½‘å…³ï¼š
    	print(cfgAdapter.DNSHostName[1]);//è®¡ç®—æœºå
    	print(cfgAdapter.IPAddress[1]);//IPåœ°å€
    	print(cfgAdapter.DNSServerSearchOrder[1]);//é»˜è®¤ DNS
    	print(cfgAdapter.IPSubnet[1]);//å­ç½‘æ©ç 
    	print(cfgAdapter.MACAddress);//M ACåœ°å€       
}

var wmi = com.wmi();
var display = wmi.instancesof("Win32_videocontroller") 
for index, video in com.each(display) { 
	print(video.DeviceId);//æ˜¾ç¤ºå¡
	print(video.Name);
	print(math.size64(video.AdapterRAM).format())
}

 