# aardio è°ƒç”¨ .NET å…¥é—¨æŒ‡å—

[ğŸ…° .NET ç±»å‹è½¬æ¢](type-conversion.md) [ğŸ“„ è°ƒè¯• .NET ç¨‹åºé›†](debug.md) [ğŸ’» .NET è¿è¡Œæ—¶ç‰ˆæœ¬](clr.md)

## å¯¼å…¥ .NET åå­—ç©ºé—´	<a id="import" href="#import">&#x23;</a>


ç¤ºä¾‹ï¼š

```aardio
import dotNet;

/*
åŠ è½½ .NET ç¨‹åºé›†(DLLæ–‡ä»¶)ï¼Œå‚æ•°å¯ä»¥æ˜¯ç¨‹åºé›†åæˆ–è€…æ–‡ä»¶è·¯å¾„ã€‚
é»˜è®¤ä¼šæœç´¢ç³»ç»Ÿç›®å½•ã€åº”ç”¨ç¨‹åºç›®å½•ã€æˆ– "/bin/" ç›®å½•ä¸‹çš„ç¨‹åºé›†ã€‚
*/
var assembly = dotNet.load("System");

//å¯¼å…¥ .NET åå­—ç©ºé—´
assembly.import("System");

//è°ƒç”¨ .NET åå­—ç©ºé—´çš„æˆå‘˜
var v = System.Uri.CheckHostName("www.aardio.com") 
```

å¦‚æœç¨‹åºé›†ä¸è¦å¯¼å…¥çš„åå­—ç©ºé—´ç›¸åŒå¯è°ƒç”¨ dotNet.import å‡½æ•°å¯¼å…¥ï¼š

```aardio
//å¯¼å…¥ç¨‹åºé›†ä»¥åŠä¸ç¨‹åºé›†ä¸åŒåçš„åå­—ç©ºé—´
dotNet.import("System");
```

## ä½¿ç”¨ dotNet.loadFile åŠ è½½ç¨‹åºé›† <a id="loadFile" href="#loadFile">&#x23;</a>


dotNet.load å¯ä»¥ä½¿ç”¨å‚æ•°æŒ‡å®šçš„ç¨‹åºé›†çŸ­åç§°æœç´¢å¹¶åŠ è½½ç¨‹åºé›†ï¼Œè€Œ dotNet.loadFile åˆ™æ˜¯åŠ è½½å‚æ•°ä¸­æŒ‡å®šçš„å…·ä½“ç¨‹åºé›†ï¼Œ

dotNet.loadFile( assemblyPathOrData ) å‚æ•° @1assemblyPathOrData å¯æŒ‡å®šç¨‹åºé›†æ–‡ä»¶è·¯å¾„ã€èµ„æºæ–‡ä»¶è·¯å¾„æˆ–è€…ç¨‹åºé›†çš„å†…å­˜æ•°æ®åŠ è½½ç¨‹åºé›†ã€‚

å†…å­˜åŠ è½½ç¨‹åºé›†ç¤ºä¾‹ï¼š

```aardio
dotNet.loadFile($"/dll/your-assembly.dll");
```

åœ¨ aardio ä¸­æ–‡ä»¶è·¯å¾„å¼€å§‹çš„å•ä¸ªæ–œæ æˆ–åæ–œæ è¡¨ç¤ºåº”ç”¨ç¨‹åºæ ¹ç›®å½•ã€‚åœ¨å¼•å·åŒ…å›´çš„æ–‡ä»¶è·¯å¾„å‰é¢åŠ ä¸€ä¸ª `$` è¡¨ç¤ºå°†è¯¥æ–‡ä»¶ç›´æ¥ç¼–è¯‘åˆ°å†…å­˜ï¼ˆå‘å¸ƒåä¸å†éœ€è¦åŸå§‹æ–‡ä»¶ï¼‰ã€‚

ä½¿ç”¨ dotNet.loadFile( assemblyPathOrData,pdbPath ) æ ¼å¼è°ƒç”¨æ—¶ï¼Œå¯ç”¨ pdbPath å‚æ•°æŒ‡å®šè°ƒè¯•æ–‡ä»¶è·¯å¾„ã€‚

## æ³¨å†Œå†…å­˜ç¨‹åºé›† <a id="reference" href="#reference">&#x23;</a>


dotNet.loadFile åŠ è½½çš„ç¨‹åºé›†ä¸èƒ½ä½œä¸ºå…¶ä»–ç¨‹åºé›†çš„ä¾èµ–é¡¹ã€‚

å¦‚æœç¨‹åºé›†ä¹‹é—´ç›¸äº’ä¾èµ–ï¼Œåº”å½“å¦‚ä¸‹æ³¨å†Œè™šæ‹Ÿç¨‹åºé›†ã€‚

```aardio
dotNet.reference({
 
	//ç­‰å·å‰é¢æ˜¯ç¨‹åºé›†çŸ­åç§°ï¼Œç­‰å·åé¢æ˜¯ DLL å†…å­˜æ•°æ®
	"assemblyName" = $ "/dll/your-assembly.dll";
	 
	"assemblyName2" = $"/dll/your-assembly2.dll";	
}) 
```

å½“ .NET æ‰¾ä¸åˆ°ç¨‹åºé›†æ—¶ï¼Œä¼šåˆ° dotNet.reference åˆ›å»ºçš„è™šæ‹Ÿç¨‹åºå¼•ç”¨è¡¨ä¸­æœç´¢ï¼Œè™šæ‹Ÿç¨‹åºé›†ä¸ä½†æ”¯æŒ aardio ä»£ç ï¼Œä¹Ÿèƒ½æ”¯æŒ .NET ä»£ç ã€‚

åªè¦è°ƒç”¨ dotNet.reference æ³¨å†Œè™šæ‹Ÿç¨‹åºé›†ï¼Œå…¶ä»–åŠ è½½ç¨‹åºé›†çš„ä»£ç å°±ä¸ç”¨å†ä¿®æ”¹ï¼Œè¿™æ ·å¯ä»¥éå¸¸æ–¹ä¾¿åœ°æ”¯æŒç”Ÿæˆç‹¬ç«‹ EXE æ–‡ä»¶ã€‚

## System åº“

aardio æ ‡å‡†åº“é‡Œæœ‰ä¸€ä¸ª System åº“ï¼Œ è¿™ä¸ªåº“çš„å…³é”®ä»£ç åªæœ‰ 2 å¥ï¼š

```aardio
import dotNet;
dotNet.import("System");

```

## åˆ›å»ºä¸ä½¿ç”¨ .NET å¯¹è±¡ <a id="new" href="#new">&#x23;</a>


å¯¼å…¥ .NET åå­—ç©ºé—´ä»¥ååœ¨ aardio ä¸­ä»ç„¶è¦é€šè¿‡å®Œæ•´çš„åå­—ç©ºé—´è®¿é—® .NET å¯¹è±¡ï¼Œè¿™ä¸ C# ä½¿ç”¨ using è¯­å¥å®ç°ç•¥å†™åç©ºç©ºé—´çš„ç”¨æ³•æ˜¯ä¸åŒçš„ã€‚

ä½†æˆ‘ä»¬å¯ä»¥å°†åå­—ç©ºé—´èµ‹å€¼ä¸ºæ›´çŸ­çš„å˜æ˜¯ï¼Œä¾‹å¦‚ï¼š

```aardio
var Uri = System.Uri;

//è°ƒç”¨ .NET ç±»æ„é€ å¯¹è±¡å®ä¾‹ï¼Œåœ¨ aardio é‡Œä¸éœ€è¦å†™ new å…³é”®å­—ã€‚
var uri = Uri("https://www.aardio.com/?q=.NET")

```

åœ¨ aardio ä¸­ä½¿ç”¨ .NET æ¯”è¾ƒç®€å•ï¼Œç¤ºä¾‹ï¼š

```aardio
//è¯»æˆ–å†™ .NET å¯¹è±¡çš„å®ä¾‹å±æ€§
var host = uri.Host 

//è°ƒç”¨ .NET å¯¹è±¡å®ä¾‹çš„æˆå‘˜å‡½æ•°
var hash =  uri.GetHashCode();

//.NET å¯¹è±¡è¿˜å¯ä»¥ç”¨ tostring è½¬æ¢ä¸ºå­—ç¬¦ä¸²
var str =  tostring(uri) ; 
```

aardio å®˜æ–¹å»ºè®®çš„å‘½åè§„èŒƒï¼š

- aardio ä»£ç é»˜è®¤ä½¿ç”¨å°é©¼å³°å‘½åé£æ ¼ï¼Œå°å†™é¦–å­—æ¯ã€‚
- aardio é€šå¸¸ç”¨å¤§å†™é¦–å­—æ¯è¡¨æ˜å¯¹è±¡æ¥è‡ªå¤–éƒ¨æ¥å£ï¼Œä¾‹å¦‚ COM æ¥å£å‡½æ•°ï¼ŒDLL æ¥å£å‡½æ•°ï¼Œ.NET åå­—ç©ºé—´æˆ–ç±»åé€šå¸¸ä¼šå¤§å†™é¦–å­—æ¯ã€‚ä½†ä½¿ç”¨ .NET ç±»æ„é€ å®ä¾‹å¯¹è±¡é€šå¸¸å°å†™é¦–å­—æ¯ï¼Œä¾‹å¦‚ä¸Šé¢çš„ `uri` ã€‚

aardio ä»£ç å»ºè®®ä½¿ç”¨å°é©¼å³°å‘½åé£æ ¼å°å†™å˜é‡åçš„é¦–å­—æ¯ã€‚

.NET ç±»ä¸€èˆ¬å¤§å†™é¦–å­—ç¬¦ï¼Œaardio å®ç°çš„ç±»é€šå¸¸å°å†™é¦–å­—ç¬¦ã€‚

## ç±»å‹è½¬æ¢ <a id="type-conversion" href="#type-conversion">&#x23;</a>


aardio ä¸­çš„åŸºç¡€ç±»å‹ï¼š

- å­—ç¬¦ä¸²ã€å­—èŠ‚æ•°ç»„ï¼ˆbufferï¼‰ã€å¸ƒå°”å€¼ç­‰å¯ç›´æ¥ç”¨äº .NET
- è€Œæ•´æ•°åœ¨ .NET ä¸­ç±»å‹ä¸º intï¼Œå°æ•°åœ¨åœ¨ .NET ä¸­ç±»å‹ä¸º doubleã€‚
- æ•°å€¼ç±»å‹çš„æ•°ç»„åœ¨ .NET ä¸­å¯¹åº” `double[] `  
- å­—ç¬¦ä¸²æ•°ç»„åœ¨ .NET ä¸­å¯¹åº” `strng[] `  
- å…¶ä»–æ•°ç»„ åœ¨ .NET ä¸­å¯¹åº” `object[]
- å…¶ä»– table å¯¹è±¡åœ¨ .NET ä¸­å¯¹åº” object,System.__ComObject,dynamic å¯¹è±¡ã€‚ 

.NET ä¸­çš„å€¼åœ¨ aardio ä¸­åˆ™åˆ†ä¸ºä¸¤ç±»ï¼š

1. nullå€¼ã€æ•°å€¼ã€å­—ç¬¦ä¸²ã€æšä¸¾ã€ System.Drawing.Color ç­‰ç®€å•å€¼ç±»å‹ï¼Œä»¥åŠè¿™äº›å€¼ç±»å‹çš„æ•°ç»„å¯ä»¥ç›´æ¥äº¤æ¢ã€‚ 
2. å…¶ä»–åŸç”Ÿ .NET å¯¹è±¡åœ¨ aardio ä¸­å­˜ä¸º com.NETObject å¯¹è±¡ï¼ˆå¯¹åº” .NET ä¸­çš„ System.__ComObject ç±»å‹ï¼‰ã€‚

.NET ä¸ aardio äº¤äº’çš„åº•å±‚æ¥å£æ˜¯ COM æ¥å£ï¼Œ.NET å¯¹è±¡åœ¨ aardio ä¸­å†…é‡Œæœ¬è´¨æ˜¯ä¸€ä¸ª COM å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ `com.Release()`æå‰æ˜¾å¼é‡Šæ”¾ .NET å¯¹è±¡ï¼ˆ ä¸€èˆ¬ä¸éœ€è¦è¿™æ ·åšï¼Œä¼šè‡ªåŠ¨å›æ”¶å†…å­˜ ï¼‰ã€‚COM åªæ˜¯åŸºç¡€æ¥å£ï¼Œaardio ä¸ .NET çš„å®é™…äº¤äº’æ˜¯é€šè¿™ .NET åå°„å®ç°äº¤äº’è°ƒç”¨ã€‚

éƒ¨åˆ†æ— æ³•ç›´æ¥æ“ä½œçš„.NET å¯¹è±¡ä¼šè¢«å°è£…ä¸º dotNet.object å¯¹è±¡ï¼ˆåœ¨ .NET é‡Œæ˜¯ä¸€ä¸ª DispatchableObject å¯¹è±¡ ï¼‰ï¼ŒdotNet.object ä¹Ÿå¯ä»¥ç”¨äºåˆ›å»ºéœ€è¦åœ¨ .NET å‡½æ•°ä¸­å¼•ç”¨ä¼ å‚çš„å¯¹è±¡ã€‚ç±»ä¼¼ dotNet.int ç­‰å‡½æ•°å¯ä»¥åˆ›å»ºç‰¹å®šç±»å‹çš„ dotNet.object ã€‚

æ›´å¤šç»†èŠ‚è¯·å‚è€ƒæ–‡æ¡£ï¼š[aardio ä¸ .NET æ•°æ®ç±»å‹è‡ªåŠ¨è½¬æ¢ ](type-conversion.md)

## åœ¨ aardio ä¸­ç¼–è¯‘ C# ä»£ç  <a id="compiler" href="#compiler">&#x23;</a>

```aardio
import dotNet; 

//åˆ›å»ºC#è¯­è¨€ç¼–è¯‘å™¨
var compiler = dotNet.createCompiler("C#");

//å¯é€‰å¼•å…¥ä¾èµ– DLL ç¨‹åºé›†(ä¸è¦å†…å­˜åŠ è½½);
//compiler.Reference("System.dll"); //System.dll é»˜è®¤å·²å¼•å…¥

//å¯é€‰æŒ‡å®šç¼–è¯‘å‚æ•°
//compiler.Parameters.CompilerOptions = "/optimize /unsafe" ;

//ä¸‹é¢æ˜¯å¾…ç¼–è¯‘çš„ C# æºä»£ç ï¼ˆ æ³¨é‡Šèµ‹å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œé¦–å°¾æ˜Ÿå·æ•°ç›®è¦åŒ¹é… ï¼‰
compiler.Source = /***
namespace CSharpLibrary  
{  
    public class Object  
    {     
        public static string Test(ref double num){   
            num = 12.3;
            return "<? ='C# ä»£ç å¯ä»¥åµŒå…¥ aardio æ¨¡æ¿ä»£ç ' ?>";
        }
    }   
} 
***/

//ç¼–è¯‘ç¨‹åºé›†å¹¶ä¸”å¯¼å…¥åå­—ç©ºé—´
compiler.import("CSharpLibrary");  //ç­‰ä»·äº compiler.Compile().import("CSharpLibrary")

//åˆ›å»º .NET å¼•ç”¨å‚æ•°ï¼ˆ double ç±»å‹ï¼‰
var ret = dotNet.double(12.5,true);

print( ret );
```

ç¼–è¯‘å¹¶ç”Ÿæˆæœ¬åœ°ç¨‹åºé›†çš„çš„å†™æ³•å¦‚ä¸‹ï¼š

```aardio
//ç¼–è¯‘ç”Ÿæˆ DLL ç¨‹åºé›†æ–‡ä»¶ï¼Œä¸æŒ‡å®šå‚æ•°ç”Ÿæˆå†…å­˜ç¨‹åºé›†
var assembly = compiler.CompileOrFail("/output.dll");

//å¯¼å…¥ç¨‹åºé›†ä¸åŒåçš„åå­—ç©ºé—´
assembly.import("CSharpLibrary");  
```

å¦‚æœ compiler.Source  æŒ‡å®šå­—ç¬¦ä¸²åˆ™æ”¯æŒä½¿ç”¨ [aardio æ¨¡æ¿è¯­æ³•](../../../language-reference/templating/syntax.md) åœ¨ `<? ?>` ä¸­é—´åµŒå…¥ aardio ä»£ç åˆ° C# ä»£ç ä¸­ä»¥ç”Ÿæˆæ–°çš„ C# ä»£ç ã€‚

åœ¨ aardio é‡Œè°ƒç”¨ .NET ç¼–è¯‘å™¨åªä¸ [CLR ç‰ˆæœ¬](clr.md#versions) æœ‰å…³ï¼Œä¸å…·ä½“ .NET ç‰ˆæœ¬æ²¡æœ‰ç›´æ¥å…³ç³»ã€‚
Win10 å·²è‡ªå¸¦ .NET 4.x ï¼ˆ CLR 4.0 ï¼‰ ï¼Œè€Œ CLR 2.0 ç¼–è¯‘å™¨ä¸æ”¯æŒ var ï¼Œlambda è¿™äº›è¯­æ³•ã€‚

## .NET è¿­ä»£å™¨ <a id="each" href="#each">&#x23;</a>

æ‰€æœ‰ .NET å¯¹è±¡åœ¨ aardio ä¸­éƒ½ä¼šå¢åŠ ä¸€ä¸ªå°å†™çš„ each æ–¹æ³•ç”¨äºåˆ›å»ºè¿­ä»£å™¨ã€‚
ä½†åªæœ‰æ”¯æŒè¿­ä»£æ¥å£çš„ .NET é›†åˆå¯¹è±¡æ‰èƒ½ä½¿ç”¨ each æ–¹æ³•ã€‚

ç¤ºä¾‹ï¼š

```aardio
for i,v in netArray.each() {
	// i æ˜¯è¿­ä»£åºå·ï¼ˆè‡ª 1 å¼€å§‹ï¼‰, v æ˜¯å½“å‰è¿­ä»£çš„å€¼ã€‚
	print(i,v) 
}
```

> .NET åå­—ç©ºé—´ã€ç±»åã€å¤–éƒ¨å¯è®¿é—®çš„ .NET å¯¹è±¡çš„å…¬å…±æ–¹æ³•ä¸å±æ€§åé¦–å­—æ¯ä¸€èˆ¬éƒ½ä¼šå¤§å†™ï¼Œè€Œ aardio é‡Œçš„åå­—ç©ºé—´ã€ç±»åã€å¯¹è±¡çš„æ–¹æ³•åä¸å±æ€§åé¦–å­—æ¯ä¸€èˆ¬éƒ½æ˜¯å°å†™ï¼ˆå°é©¼å³°é£æ ¼ï¼‰ã€‚åœ¨ aardio é‡Œé€šå¸¸ä¼šç”¨å‘½åæ¥åŒºåˆ† aardio å¯¹è±¡ä¸å¤–éƒ¨å¯¹è±¡ã€‚ä¾‹å¦‚ä¸€ä¸ªCOM å¯¹è±¡ æˆ–è€… .NET å¯¹è±¡å¦‚æœæä¾›äº†å°å†™é¦–å­—æ¯çš„æ–¹æ³•æˆ–å±æ€§åï¼Œè¿™é€šå¸¸æš—ç¤ºå®ƒæ˜¯ä¸€ä¸ª aardio é¢å¤–å¢åŠ çš„å±æ€§æˆ–æ–¹æ³•ã€‚ä¾‹å¦‚ä¸Šé¢çš„ `netArray.each` å°±æ˜¯ä¸€ä¸ª aardio å‡½æ•°è€Œé .NET å‡½æ•°ã€‚

## .NET ä¸‹æ ‡ <a id="index" href="#index">&#x23;</a>

 .NET å¯¹è±¡çš„ä¸‹æ ‡å®é™…ä¸Šæ˜¯è®¿é—® Item[] å±æ€§ã€‚

å¦‚æœ netObj æ˜¯ä¸€ä¸ª .NET å¯¹è±¡ï¼Œåœ¨ aardio ä¸­å†™ `netObj["key"]` æˆ– `netObj.Item["key"]` ä½œç”¨æ˜¯ç›¸åŒçš„ã€‚ä½†å¦‚æœ å¦‚æœ  `netObj["key"]` è¯»å–å€¼å¤±è´¥ä¸” netObj ä¸å­˜åœ¨ `Item[]` å±æ€§ï¼Œaardio å°†ä¼šè‡ªåŠ¨ä¿®æ”¹ä¸º `netObj.key`  è¯»å– netObj åä¸º key çš„å±æ€§ã€‚

å¦‚æœä¸‹æ ‡æ˜¯æ•°ç»„åˆ™ç•¥æœ‰ä¸åŒï¼Œé€šè¿‡ Item å±æ€§è®¿é—®ä¸‹æ ‡æ—¶æŒ‰ .NET è§„åˆ™èµ·å§‹ç´¢å¼•ä¸º 0ï¼Œä¾‹å¦‚`netObj.Item[0]` è®¿é—®ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚ä¸é€šè¿‡  Item å±æ€§å¹¶ä¸”ç›´æ¥ä½¿ç”¨æ•°å€¼ä¸‹æ ‡æ—¶æŒ‰ aardio è§„åˆ™èµ·å§‹ç´¢å¼•ä¸º 1ï¼Œä¾‹å¦‚ `netObj[1]` è®¿é—®ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚

ä¹Ÿå¯ä»¥é€šè¿‡å‡½æ•°è°ƒç”¨æ–¹å¼è®¿é—® Item å±æ€§ï¼Œæ”¯æŒå¤šå‚æ•°ï¼Œå¯é€‰æŒ‰ COM æ¥å£è§„åˆ™åŠ ä¸Š get æˆ– set å‰ç¼€ï¼Œä¾‹å¦‚ï¼š

- `var value= netObj.Item(1,2) //å¤šå‚æ•°è¯» Item å±æ€§`
- `var value= netObj.getItem(1,2) //å¤šå‚æ•°è¯»Item å±æ€§`
- `netObj.setItem(1,2,value) //å¤šå‚æ•°ä¿®æ”¹ Item å±æ€§`


## å¤šé¡¹ç´¢å¼• <a id="multiple-indexing" href="#multiple-indexing">&#x23;</a>

aardio å…è®¸åœ¨ä¸‹æ ‡æ“ä½œç¬¦ä¸­ç”¨é€—å·åˆ†éš”å¤šä¸ªç´¢å¼•å€¼ã€‚
> ä¸‹æ ‡åŒ…å«å¤šé¡¹ç´¢å¼•æ—¶ç¬¬ä¸€ä¸ªç´¢å¼•å¿…é¡»æ˜¯å•ä¸ªæ ‡è¯†ç¬¦æˆ–å­—é¢å€¼è€Œä¸èƒ½æ˜¯å¤åˆè¡¨è¾¾å¼ï¼Œåé¢çš„å…¶ä»–ç´¢å¼•åˆ™æ— é™åˆ¶ã€‚ä¾‹å¦‚å†™ä¸º `obj[x,(y+1)]` è¿™æ ·æ˜¯æ­£ç¡®çš„ï¼Œä½†å†™æˆ `obj[ï¼ˆ1ï¼‰,2]` è¿™æ ·å°±å­˜åœ¨è¯­æ³•é”™è¯¯ ã€‚

ç¤ºä¾‹ï¼š

```aardio
netObject.multiDimensionalArray[0,0] = "å€¼"
```

ä¸‹é¢çš„ä»£ç ç­‰ä»·äºä¸‹é¢çš„ä»£ç ï¼š

```aardio
//æ³¨æ„æ–¹æ‹¬å·ä¸­é—´æœ‰ä¸€ä¸ªç©ºæ ¼ä»¥é¿å…åŒ…å«æ•°ç»„çš„ [] è¢«è¯†åˆ«ä¸ºç›´æ¥ä¸‹æ ‡æ“ä½œç¬¦ã€‚
netObject.multiDimensionalArray[ [0,0] ] = "å€¼"
```

å®é™…ä¼ é€’çš„ç´¢å¼•æ˜¯ä¸€ä¸ªåŒ…å«å¤šé¡¹ç´¢å¼•çš„çº¯æ•°ç»„ï¼ˆ  [pure-array](../datatype/table/_.md#pure-array-table) ï¼‰ã€‚
aardio ä¸­çš„ COM æ¥å£ã€.NET æ¥å£å·²ç»è‡ªåŠ¨æ”¯æŒä¸Šè¿°çš„å¤šé¡¹ç´¢å¼•ã€‚

æ›´å¤šå…³äºå¤šé¡¹ç´¢å¼•çš„å†…å®¹è¯·å‚è€ƒï¼š[ä¸‹æ ‡æ“ä½œç¬¦ - å¤šé¡¹ç´¢å¼•](../../../language-reference//operator/member-access.md)


## .NET æ•°ç»„ <a id="array" href="#array">&#x23;</a>

.NET æ•°ç»„ä¼ å…¥ aardio çš„è§„åˆ™

1. åŸºæœ¬çº¯å€¼ç±»å‹å…¼å®¹çš„ .NET æ•°ç»„ã€å¤šç»´æ•°ç»„åœ¨ aardio ä¸­ å­˜ä¸º com.SafeArray æ•°ç»„ã€‚COM æ•°ç»„ä¸æ™®é€š aardio æ•°ç»„æ“ä½œå®Œå…¨ç›¸åŒã€‚
2. .NET äº¤é”™æ•°ç»„åœ¨å°åŒ…ä¸º DispatchableObject å¯¹è±¡ï¼Œç„¶åå°† DispatchableObject å¯¹è±¡å°åŒ…ä¸º aardio ä¸­çš„ dotNet.objectå¯¹è±¡ã€‚
   			
    å°åŒ…ä¸º dotNet.object çš„æ•°ç»„æ”¯æŒä»¥ä¸‹ç‰¹æ€§ï¼š
	- å¯ç”¨ Length å±æ€§è·å–æ•°ç»„é•¿åº¦ã€‚ä¾‹å¦‚ `netArray.Length` ã€‚
	- å¯ç”¨ 1 èµ·å§‹çš„ä¸‹æ ‡è®¿é—®æ•°ç»„æˆå‘˜ã€‚ä¾‹å¦‚ `netArray[1].num` ã€‚
	- æ”¯æŒ each æ–¹æ³•éå†æ•°ç»„æˆå‘˜ã€‚ä¾‹å¦‚ï¼š
    ```aardio
    for i,v in netArray.each() {
        console.log(i,v)//i æ˜¯æ•°ç»„ç´¢å¼•ï¼Œv æ‰æ˜¯æ•°ç»„å€¼
    }
    ```
	- å¯ç”¨ table.parseValue å±•å¼€ä¸ºæ™®é€šæ•°ç»„ã€‚
    
    .NET çš„ ä¸€ç»´ System.Object æ•°ç»„åœ¨ aardio ä¸­å°åŒ…ä¸º dotNet.objectã€‚å¦‚æœæ•°ç»„ä¸­å®é™…ä¿å­˜çš„æ˜¯å¯ä»¥ç›´æ¥äº’æ¢çš„é€šç”¨çº¯å€¼ï¼ˆ ä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°”å€¼ â€¦â€¦ ï¼‰ï¼Œåœ¨ aardio ä¸­å¯ç”¨ dotNet.getObject(netObjArray).Value è§£åŒ…ä¸ºåŸç”Ÿæ•°ç»„ã€‚

aardio æ•°ç»„ä¼ å…¥ .NET çš„è§„åˆ™ï¼š

1. åŸºæœ¬çº¯å€¼ç±»å‹å…¼å®¹çš„ .NET æ•°ç»„ã€å¤šç»´æ•°ç»„å¯ä»¥ç›´æ¥äº¤æ¢ã€‚
2. å…¶ä»–ç±»å‹åŒ–æ•°ç»„å¿…é¡»æ˜ç¡®åŒ¹é…å‚æ•°ä¸­æ•°ç»„çš„ç±»å‹ã€‚

    aardio ä¸­åˆ›å»º .NET ç±»å‹åŒ–æ•°ç»„çš„ä¾‹å­:
    ```aardio
    var objArray = dotNet.createArray( CSharpLibrary.Object, 2 )

    //åˆ›å»ºçš„æ•°ç»„é»˜è®¤æ˜¯ç©ºçš„ï¼Œæ·»åŠ å…ƒç´ è¿›å»
    objArray[1] = CSharpLibrary.Object(); 
    objArray[2] = CSharpLibrary.Object(); 
    ```

    ä¸‹é¢è¿™æ ·å†™ä¹Ÿå¯ä»¥ï¼Œaardio ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºç±»å‹åŒ–æ•°ç»„ã€‚

    ```aardio
    var objArray = { CSharpLibrary.Object(),CSharpLibrary.Object() } 
    ```

## .NET æ³›å‹ <a id="generic" href="#generic">&#x23;</a>

### 1. è‡ªåŠ¨åŒ¹é…  .NET æ³›å‹ç±»åŒ–å‡½æ•°

aardio æ”¯æŒé€šè¿‡è°ƒç”¨å‚æ•°çš„ç±»å‹è‡ªåŠ¨åŒ¹é… .NET æ³›å‹ï¼Œç¤ºä¾‹ï¼š

```aardio
import System.ValueTuple; 

/*
åˆ›å»º ValueTuple å¯¹è±¡ï¼Œæœ€å¤šæ”¯æŒ 8 ä¸ªå‚æ•°ã€‚
æ³¨æ„è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æ³›å‹å‡½æ•°ï¼Œaardio å¯ä»¥é€šè¿‡å‚æ•°ç±»å‹è‡ªåŠ¨åŒ¹é…æ³›å‹å‡½æ•°ã€‚
*/
var tuple = System.ValueTuple.Create(
	21,22,23,24,25,26,27,
	dotNet.double(28)  
);
```

### 2. å®ä¾‹åŒ– .NET æ³›å‹å‡½æ•°æˆ–æ³›å‹ç±»

åœ¨ aardio ä¸­å¯ä»¥åœ¨ .NET æ³›å‹ç±»åæ³›å‹æ–¹æ³•åç§°å‰é¢æ·»åŠ ä¸€ä¸ª `$` ç¬¦å·ä»¥è¿”å›æ³›å‹å®ä¾‹åŒ–æ–¹æ³•ã€‚

æ³›å‹å®ä¾‹åŒ–æ–¹æ³•å¯ä»¥æŒ‡å®šä»¥ä¸‹å‡ ç§è°ƒç”¨å‚æ•°ï¼š

- .NET ç±»ï¼Œè¿™å¯ä»¥æ˜¯ dotNet.import å¯¼å…¥çš„ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯å®é™…çš„ .NET ç±»å‹å¯¹è±¡ã€‚

  ä¾‹å¦‚ï¼š`System.Array.$Empty(System.Int32)` 

- åŒ…å« .NET ç±»å‹åç§°çš„å­—ç¬¦ä¸²

 ä¾‹å¦‚ï¼š`System.Array.$Empty("System.Int32")` 

- æŒ‡å®šå…¶ä»–ç±»å‹çš„å‚æ•°åˆ™ä¼šè·å–è¯¥å‚æ•°çš„ .NET ä½œä¸ºæ³›å‹å®ä¾‹åŒ–å‚æ•°ã€‚

  ä¾‹å¦‚ï¼š`System.Array.$Empty(0)` 

ç¤ºä¾‹ï¼š

```aardio 
import dotNet

//å®ä¾‹åŒ– .NET æ³›å‹å‡½æ•°
EmptyInt32Array = System.Array.$Empty("System.Int32")

//åˆ›å»ºç©ºçš„ .NET æ•°ç»„å®ä¾‹
var arr = EmptyInt32Array();
```

### 3. å®ä¾‹åŒ– .NET æ³›å‹ç±»

å®ä¾‹åŒ–æ³›å‹ç±»é™¤äº†æ”¯æŒä¸Šé¢çš„ 3 ç§å†™æ³•ä»¥å¤–ï¼Œè¿˜é¢å¤–æ”¯æŒä»¥ä¸‹ä¸¤ç§å†™æ³•ï¼š

- ä½¿ç”¨æ³›å‹ç±»çš„ `$` æ–¹æ³•å®ä¾‹åŒ–æ³›å‹ï¼Œä¾‹å¦‚ï¼š

	```aardio
	StringList = System.Collections.Generic.List.$(System.String)
	```

	ä½¿ç”¨è¿™ç§æ–¹æ³•å®ä¾‹åŒ–çš„æ³›å‹ç±»ä¸ä¼šä¿å­˜äº System.Collections.Generic åå­—ç©ºé—´ï¼Œåªèƒ½è‡ªè¿”å›å€¼æ¥æ”¶ã€‚

- æŒ‰ .NET çš„åŸç”Ÿæ³›å‹ç±»å‘½åè§„åˆ™è·å–æ³›å‹å®ä¾‹ï¼Œä¾‹å¦‚ï¼š

	```aardio
	StringList = System.Collections.Generic["List`1[System.String]"]
	```

	ä¸Šé¢ä»£ç é‡Œï¼Œåå¼•å·åé¢çš„æ•°å­—æ˜¯æŒ‡å‚æ•°çš„æ•°ç›®ï¼Œ`[]`å†…æ˜¯å‚æ•°çš„ .NET ç±»å‹ï¼Œå¤šä¸ªå‚æ•°ç±»å‹ç”¨é€—å·åˆ†å¼€ã€‚

	è¿™ç§å†™æ³•ä¼šåœ¨ System.Collections.Generic åå­—ç©ºé—´ç›´æ¥å­˜å‚¨å®ä¾‹åŒ–çš„æ³›å‹ç±»ï¼Œä¸‹æ¬¡ä»¥ç›¸åŒçš„åç§°è·å–æ—¶å°±ä¼šç›´æ¥è¿”å›ã€‚

## .NET å§”æ‰˜å›è°ƒ <a id="delegate" href="#delegate">&#x23;</a>


.NET å§”æ‰˜è‡ªåŠ¨æ”¯æŒ aardio å‡½æ•°å¯¹è±¡ã€‚

.NET çš„è°ƒç”¨å‚æ•°ã€å±æ€§éƒ½æ”¯æŒç›´æ¥ä¼ å…¥ aardio å‡½æ•°ï¼Œç¤ºä¾‹ï¼š

```aardio
//å‡½æ•°å‚æ•°ä¼ å…¥å§”æ‰˜
netObj.Hello(function(){
	//æ— è®º .NET ä»£ç æ˜¯åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œè¢« .NET å›è°ƒçš„ aardio å‡½æ•°æ€»æ˜¯åœ¨åŸè°ƒç”¨çº¿ç¨‹æ‰§è¡Œï¼ˆä¸å¿…è€ƒè™‘å¤šçº¿ç¨‹è§„åˆ™ä¸åŒæ­¥ï¼‰ã€‚  
  	console.log("3ã€aardio å‡½æ•°è¢« C# è°ƒç”¨äº†,å‚æ•°:",a,b)
	return 2; //å¦‚æœä¸è¿”å›å§”æ‰˜æŒ‡å®šç±»å‹çš„è¿”å›å€¼ä¼šå¯¼è‡´æŠ¥é”™ï¼Œå§”æ‰˜è¿”å›å€¼ç±»å‹ä¸º void æ—¶è¿™é‡Œå¯ä»¥ä¸è¿”å›å€¼ã€‚
})
  
//å§”æ‰˜å›è°ƒå¯ä»¥ç›´æ¥èµ‹å€¼ä¸º aardio å‡½æ•°å¯¹è±¡
netObj.callback = function(a,b){
    console.log("1ã€aardio å‡½æ•°è¢« C# è°ƒç”¨äº†,å‚æ•°:",a,b)
	return 1; 
} 
```

ä¹Ÿå¯ä»¥å¦‚ä¸‹è¿½åŠ å§”æ‰˜å›è°ƒå‡½æ•°ï¼š

```aardio
//ä¹Ÿå¯ä»¥è¿™æ ·è¿½åŠ å§”æ‰˜å›è°ƒå‡½æ•°
dotNet.delegate.combine(
	netObj,"callback",function(a,b){
    	console.log("2ã€aardio å‡½æ•°è¢« C# è°ƒç”¨äº†,å‚æ•°:",a,b)
		return 2; 
	} 
)
```

è‡³äº .NET ä¸­çš„ event å®é™…ä¸Šæ˜¯åœ¨å§”æ‰˜ï¼ˆdelegateï¼‰ä¸Šå†åšäº†å±‚å°è£…ã€‚åœ¨ aardio ä¸­å¯¹ event èµ‹å€¼æ€»æ˜¯è¿½åŠ è€Œä¸æ˜¯è¦†ç›–ï¼ˆå¯¹delegate èµ‹å€¼åˆ™æ€»æ˜¯è¦†ç›–è€Œä¸æ˜¯è¿½åŠ ï¼‰ï¼Œç”¨æ³•ä¸å§”æ‰˜åŸºæœ¬ç›¸åŒã€‚

## dynamic ä¸ InvokeMember <a id="dynamic" href="#dynamic">&#x23;</a>


InvokeMember æ˜¯é€šè¿‡åå°„è°ƒç”¨ aardio å¯¹è±¡ï¼Œå‚è€ƒ [InvokeMember èŒƒä¾‹](doc://example/Languages/dotNet/Delegate/InvokeMember.html) ã€‚

dynamic åˆ™æ›´ä¸ºç®€æ´å’Œå¼ºå¤§ï¼Œåªè¦åœ¨ C# ä¸­å°† aardio å¯¹è±¡å£°æ˜ä¸º dynamicç±»å‹å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚.NET 4.x éƒ½æ”¯æŒ dynamic å¯¹è±¡ï¼Œ è€Œ Win10 å·²è‡ªå¸¦.NET 4.6 ä»¥ä¸Šï¼Œæ‰€ä»¥å¦‚æ˜¯æœä¸€å®šè¦è€ƒè™‘ Win7 ç³»ç»Ÿå¯ä»¥ç”¨ InvokeMember æ›¿ä»£ï¼Œå¦åˆ™ä½¿ç”¨ dynamic ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚

dynamic éå¸¸ç®€å•ï¼Œå”¯ä¸€è¦æ³¨æ„çš„æ˜¯ dynamic æ˜¯ç”± .NET é€šè¿‡ COM æ¥å£è°ƒç”¨ aardio å¯¹è±¡ï¼Œå¦‚æœå›è°ƒå‚æ•°ä¸­æœ‰éåŸºç¡€çº¯å€¼ç±»å‹çš„ .NET å¯¹è±¡ä¸ä¼šè‡ªåŠ¨è½¬æ¢ä¸º dotNet.Objectï¼Œéœ€è¦æ‰‹åŠ¨è½¬æ¢ä¸€ä¸‹ï¼Œä¾‹å¦‚ `netObj = dotNet.object(netObj)`, dotNet.Object åŸºäº .NET åå°„å¯ä»¥æ”¯æŒæ›´å¤š .NET ç‰¹æ€§ï¼Œä¾‹å¦‚é‡è½½ï¼ˆå‡½æ•°åç›¸åŒï¼Œå‚æ•°ä¸åŒï¼‰ã€‚

å‚è€ƒ [dynamic èŒƒä¾‹](doc://example/Languages/dotNet/Delegate/dynamic.html)

## æ‰©å±• .NET ç±» <a id="ctor" href="#ctor">&#x23;</a>


å¯¼å…¥çš„ .NET ç±»å¦‚æœå®šä¹‰åä¸º `ctor(...)` çš„æ‰©å±•æ„é€ å‡½æ•°ã€‚åˆ™è¯¥å‡½æ•°å°†åœ¨ aardio æ„é€  .NET ç±»ä¹‹å‰è‡ªåŠ¨æ‰§è¡Œã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š

```aardio
import dotNet;
dotNet.import("System"); 


System.Uri[["ctor(...)"]] = function(netCtor,url,...){
	
	//åœ¨è¿™é‡Œå¯ä»¥æ”¹åŠ¨ã€æ£€æµ‹æ„é€ å‚æ•°
	if(!url) error("å‚æ•° @1 è¯·æŒ‡å®šç½‘å€",3);
	
	//è°ƒç”¨çœŸå®çš„æ„é€ å‡½æ•° netCtor åˆ›å»ºå¯¹è±¡ï¼Œè¯¥å‡½æ•°æˆåŠŸè¿”å›å¯¹è±¡ï¼Œå¤±è´¥è¿”å› null,é”™è¯¯ä¿¡æ¯
	var obj,err = netCtor(url,...); //è¿”å›æ–°çš„æ„é€ å‚æ•°
	
	//è¿”å›åˆ›å»ºçš„å¯¹è±¡
	return obj,err;
} 
```

åœ¨ aardio ä¸­å®ä¾‹åŒ– .NET ç±»ä»¥åï¼Œå¯è‡ªåŠ¨è°ƒç”¨åä¸º "ctor" çš„æ‰©å±•æ„é€ å‚æ•°ï¼ˆä¸èƒ½æ‹¦æˆªæ„é€ å‚æ•°ï¼Œä¹Ÿä¸éœ€è¦è¿”å›å€¼ï¼‰ã€‚ è¿™ä¸ªå‡½æ•°çš„å‚æ•°å°±æ˜¯å·²ç»åˆ›å»ºçš„ .NET å¯¹è±¡å®ä¾‹ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š

```aardio
import dotNet;
dotNet.import("System"); 

//this å‚æ•°ä¸ºå·²åˆ›å»ºçš„ .NET å¯¹è±¡å®ä¾‹
System.Uri[["ctor"]] = function(this){ 
	
	/*
	aardio è¯»å†™ .NET å¯¹è±¡çš„æˆå‘˜ä¼šè§¦å‘å¯¹è±¡å…ƒæ–¹æ³•å¹¶è½¬æ¢ä¸º .NET è°ƒç”¨ã€‚
	å¦‚æœæ”¹ç”¨ç›´æ¥ä¸‹æ ‡ [[]] å°±å¯ç›´æ¥è¯»å†™å¯¹è±¡çš„æˆå‘˜ï¼Œä¸ä¼šè§¦å‘å…ƒæ–¹æ³•ä¹Ÿä¸ä¼šè§£æä¸º .NET è°ƒç”¨ã€‚
	*/
	this[["getHostAndHashCode"]] = function(){
		return owner.Host,owner.GetHashCode();
	}	
}
```

[å®Œæ•´èŒƒä¾‹](doc://example/Languages/dotNet/Advanced/raw-index.html)

## .NET å­—å…¸ï¼ˆDictionaryï¼‰ <a id="dict" href="#dict">&#x23;</a>


.NET å­—å…¸ï¼ˆDictionaryï¼‰æ˜¯æ³›å‹ç±»ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·åˆ›å»º Dictionaryã€‚

```aardio
var Dictionary = System.Collections.Generic.Dictionary.$(System.String,System.String)
var dict = Dictionary();
```

æ›´ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ dotNet.dict åˆ›å»º .NET å­—å…¸ï¼ˆDictionaryï¼‰ ã€‚
å‚æ•° `@1` æŒ‡å®šä¸€ä¸ª aardio `éç©ºè¡¨`ï¼Œ`é”®`çš„æ•°æ®ç±»å‹å¿…é¡»ç›¸åŒï¼Œ`å€¼`çš„æ•°æ®ç±»å‹ä¹Ÿå¿…é¡»ç›¸åŒã€‚å‚æ•° `@2` å¦‚æœä¸º `true` åˆ™è¿”å›å¯¹è±¡å¯ç”¨äº .NET è¾“å‡ºå¼•ç”¨å‚æ•°ï¼Œå‚æ•° `@2` æ˜¯å¯é€‰å‚æ•°ã€‚

```aardio
import dotNet; 

var dict = dotNet.dict(
	a="abc",
	d="789"
)

dict["a"] = "æ–°çš„å€¼";
var v = dict["a"];

print(v);

```

## åµŒå…¥ .NET æ§ä»¶åˆ° aardio çª—å£ <a id="ui" href="#ui">&#x23;</a>

æ³¨æ„åªæœ‰åœ¨ç•Œé¢çº¿ç¨‹ä¸­æ‰èƒ½å°† .NET æ§ä»¶åµŒå…¥åˆ° aardio çª—å£ä¸­ã€‚

åµŒå…¥ .NET æ•°æ®è¡¨æ ¼ç¤ºä¾‹ï¼š

```aardio
import win.ui;
/*DSG{{*/
var winform = win.form(text="åµŒå…¥ .NET æ•°æ®è¡¨æ ¼";right=759;bottom=510)
winform.add(
button={cls="button";text="è¯»å–æ•°æ®";left=495;top=439;right=739;bottom=504;color=14120960;db=1;dr=1;font=LOGFONT(h=-14);note="è·å–æ•°æ®æºä¸­çš„æ•°æ®";z=3};
custom={cls="custom";left=25;top=25;right=736;bottom=274;db=1;dl=1;dr=1;dt=1;z=1};
edit={cls="edit";left=26;top=290;right=737;bottom=435;autohscroll=false;db=1;dl=1;dr=1;edge=1;multiline=1;vscroll=1;z=2}
)
/*}}*/

import System;
import System.Data;
import System.Windows.Forms; 

//.NET æ§ä»¶å¿…é¡»ç”¨ System.Windows.Forms.CreateEmbed æ‰èƒ½åµŒå…¥ aardio çª—å£
var dataGridView = System.Windows.Forms.CreateEmbed("DataGridView",winform.custom);  
dataGridView.EditMode = 2; 

//æ·»åŠ æ•°æ®åˆ—
var dataTable = System.Data.DataTable("DT"); 
dataTable.Columns.Add("åç§°");//æ·»åŠ åˆ—
dataTable.Columns.Add("è®¡æ•°",System.Double); //æ·»åŠ æŒ‡å®šæ•°æ®ç±»å‹çš„åˆ—
dataTable.Columns.Add("é€‰æ‹©",System.Boolean); //è‡ªåŠ¨æ˜¾ç¤ºå¤é€‰æ¡† 

//ç»‘å®šæ•°æ®æºåˆ°è§†å›¾
var dataView = System.Data.DataView(dataTable);
dataGridView.DataSource = dataView;

//æ›¿æ¢åå­—ä¸º"åç§°"çš„åˆ—ä¸ºä¸‹æ‹‰æ¡†æ§ä»¶ï¼ˆå‚è€ƒ System.Windows.Forms åº“æºç ï¼‰
dataGridView.ReplaceNameValueListColumn("åç§°",120/*å®½åº¦*/,
	{ "ç‹äº”","å¼ ä¸‰","æå››"},
	{ "WangWu","ZhangSan","LiSi"}
); 
	
//æ·»åŠ æµ‹è¯•æ•°æ®
var row = dataTable.NewRow(); 
row.ItemArray = {"WangWu",123, true}
dataTable.Rows.Add(row);   

/*
å¯ä»¥ç”¨ FillFromArray å‡½æ•°ä¸€æ¬¡æ€§å¡«å……æ•°æ®ã€‚
é¿å…å¯†é›†è°ƒç”¨ .NET å‚æ•°ï¼Œå‡å°‘ä¸å¿…è¦çš„è·¨è¯­è¨€äº¤äº’æˆæœ¬ã€‚
FillFromArray å®ç°è¯·æŸ¥çœ‹ System.Data.DataTable æºç ã€‚
*/
dataTable.FillFromArray({
	{"ZhangSan",456,false};
	{"LiSi",789,true}
})

//æ·»åŠ äº‹ä»¶(event)
dataTable.ColumnChanged = function(sender,eventArgs){
	var columnName = eventArgs.Column.ColumnName;
	var value  = eventArgs.Row.getItem(columnName);  
	winform.edit.print("å·²æ”¹å˜åˆ—ï¼š",columnName," å·²å˜æ›´å€¼ï¼š",value);
}

//è¯»å–æ•°æ®
winform.button.oncommand = function(id,event){ 
	
	//ä¸€æ¬¡è¯»å–æ‰€æœ‰æ•°æ®åˆ° aardio æ•°ç»„
	var data = dataTable.ExtractToArray();
	
		//è¾“å‡ºç»“æœ
	for(i=1;#data;1){  
			winform.edit.dump(  data[i]  )  
	}
	
	//ä¿®æ”¹æ•°æ®
	data[1][2]= 999;
	
		//ä¸€æ¬¡æ€§æ›¿æ¢å¹¶æ›´æ–°åŸæ¥çš„æ•°æ®ï¼Œæ›´å¿«
	dataTable.FillFromArray(data,true)
	
		//ä¸‹é¢æ˜¯æ›´åŸå§‹çš„æ–¹æ³•ï¼Œè·¨è¯­è¨€äº¤äº’æ¬¡æ•°å¤šä¸€äº›
	/*
	for(i=1;dataTable.Rows.Count;1){ 
			var arr = dataTable.Rows[i].ItemArray; 
			winform.edit.print( arr[1] ; 
	} 
	*/
}

winform.show();
win.loopMessage();
```

## è°ƒç”¨ UIA æ¥å£ <a id="uia" href="#uia">&#x23;</a>


åŸºç¡€ç”¨æ³•ï¼š

```aardio
import System.Windows.Automation;

//è®¿é—® .NET ç±»çš„é™æ€æˆå‘˜
Automation = System.Windows.Automation;
AutomationElement = Automation.AutomationElement;

//ç›´æ¥è·å–å½“å‰è¾“å…¥ç„¦ç‚¹çª—å£çš„ UIA èŠ‚ç‚¹å¯¹è±¡
var ele = AutomationElement.RootElement.FocusedElement;
assert(ele,"è¾“å…¥ç„¦ç‚¹çª—å£æ²¡æœ‰æ‰¾åˆ° UIA èŠ‚ç‚¹")

//è·å–çª—å£å¥æŸ„ 
var hwnd = editBox.Current.NativeWindowHandle;

//è‡ªçª—å£å¥æŸ„å¾—åˆ° AutomationElement å¯¹è±¡
ele = Automation.AutomationElement.FromHandle(hwnd);

//é¼ æ ‡æ“ä½œï¼Œç§»åŠ¨é¼ æ ‡åˆ°æ§ä»¶ä½ç½®
import mouse;

//æ³¨æ„éœ€è¦é€šè¿‡ Current æˆå‘˜è®¿é—® UIA å¯¹è±¡çš„å±æ€§
mouse.moveTo(ele.Current.BoundingRectangle);
```

æŸ¥æ‰¾çª—å£:

```aardio
//å¯¼å…¥ .NET ç±»  
import System.Windows.Automation;

//è®¿é—® .NET ç±»çš„é™æ€æˆå‘˜
Automation = System.Windows.Automation;   

//æŸ¥æ‰¾çª—å£ã€‚ç”± System.Windows.Automation.And ç”ŸæˆæŸ¥è¯¢æ¡ä»¶ã€‚
var notepad = Automation.FindByAnd({
	ClassName = "Notepad",
	ControlType = "Window";
}) 
 
//æŸ¥æ‰¾å†™å­—æ¿çš„ç¼–è¾‘æ¡†ã€‚ç”± System.Windows.Automation.Or ç”ŸæˆæŸ¥è¯¢æ¡ä»¶ã€‚ 
var editBox = Automation.FindByOr({
	ClassName = {"RichEditD2DPT","RICHEDIT50W","Edit" } 
},notepad) 

 
var textPattern = editBox.GetCurrentPattern(Automation.TextPattern.Pattern);
	
//è·å–å…¨éƒ¨æ–‡æœ¬
var text = textPattern.DocumentRange.GetText(-1);

print(text);

print( editBox.Current.LocalizedControlType )
```

`import System.Windows.Automation` æ”¹ä¸º 
`import System.Windows.Automation.3` å¯æ”¯æŒ TextPattern2 ç­‰æ¥å£ï¼Œè¿™ä¸¤ä¸ªåº“ä½¿ç”¨æ—¶éƒ½è¦å†™ä¸º `System.Windows.Automation`ï¼Œç”¨æ³•ä¹Ÿå®Œå…¨ç›¸åŒã€‚ä½†åŒä¸€ä¸ªç¨‹åºé‡Œåªèƒ½ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªã€‚æ ‡å‡†åº“ä¸­ winex.caret, winex.selection, winex.wpfCaret ç­‰åº“å·²ç»åŒ…å« `import System.Windows.Automation.3`ã€‚

## è°ƒç”¨ UWP / WinRT æ¥å£ <a id="uwp" href="#uwp">&#x23;</a>

aardio æä¾› dotNet.uwpCompiler å¯ç”¨äºå¿«é€Ÿåˆ›å»ºå¯ç”¨ UWP / WinRT æ¥å£çš„ .NET ç¼–è¯‘å™¨ï¼Œä¸éœ€è¦å¤æ‚çš„é…ç½®ã€‚

> æ ‡å‡†åº“ [dotNet.ocr](../../../library-reference/dotNet//ocr/_.html)ï¼Œæ‰©å±•åº“  [dotNet.toastListener](../../../library-reference/dotNet/toastListener/_.html) éƒ½ä½¿ç”¨äº† [ddotNet.uwpCompiler](../../../library-reference/dotNet/uwpCompiler/_.html)  ç¼–è¯‘çš„ DLL ç¨‹åºé›†ä»¥è°ƒç”¨ UWP æ¥å£ã€‚

ä½¿ç”¨ dotNet.uwpCompiler ç¼–è¯‘ C# ä»£ç éœ€è¦å…ˆå®‰è£… [Windows 10 SDK](https://developer.microsoft.com/zh-cn/windows/downloads/windows-sdk/) ï¼ŒdotNet.uwpCompiler éœ€è¦å¼•ç”¨ Windows 10 SDK æä¾›çš„ Windows Runtime å…ƒæ•°æ®æ–‡ä»¶ Windows.winmd ã€‚ 

> å¦‚æœä»…ä»…æ˜¯è°ƒç”¨ç¼–è¯‘åçš„ DLL ä¸éœ€è¦ Windows 10 SDK æˆ–è€… Windows.winmd  ã€‚

åœ¨ aardio ä¸­å¯ç”¨ UWP æ¥å£ç¼–è¯‘ C# ä»£ç ç”Ÿæˆ DLL ç¤ºä¾‹ï¼š

```aardio
import console.int;
import dotNet.uwpCompiler;

//åˆ›å»ºå¯ç”¨ UWP / WinRT æ¥å£çš„ .NET ç¼–è¯‘å™¨
var uwpCompiler = dotNet.uwpCompiler("/uwpTest.dll")
uwpCompiler.Parameters.CompilerOptions = "/optimize"

//C# æºä»£ç 
uwpCompiler.Source = /****** 
using System; 
using System.Threading.Tasks; 

namespace aardio.WinRT{

	public class API {
		
		//å¼‚æ­¥å‡½æ•°
    	public async Task<bool> LaunchUriAsync(string uri) {
        	return await Windows.System.Launcher.LaunchUriAsync(
        		new Uri(uri)
        	);
    	}
    	
    	//å¼‚æ­¥å‡½æ•°è½¬æ¢ä¸ºåŒæ­¥å‡½æ•°
    	public bool LaunchUri(string uri){   
    		return LaunchUriAsync(uri).GetAwaiter().GetResult();
    	}  
	}
}
******/

//ç¼–è¯‘å¹¶ç”Ÿæˆ DLL
var ret = uwpCompiler.Compile();
print( ret ? "ç¼–è¯‘æˆåŠŸ" : uwpCompiler.getLastError() );
```

è°ƒç”¨ç¼–è¯‘åçš„ç¨‹åºé›†ï¼š

```aardio
//åŠ è½½ç¼–è¯‘åçš„ç¨‹åºé›†
var assembly = dotNet.load("/uwpTest.dll");

//å¯¼å…¥åå­—ç©ºé—´
assembly.import("aardio.WinRT");

//åˆ›å»º .NET å¯¹è±¡
var uwp = aardio.WinRT.API();

//è°ƒç”¨åŒæ­¥æ–¹æ³•
uwp.LaunchUri("ms-screenclip:");

```

å¦‚æœæ˜¯è°ƒç”¨å¼‚æ­¥å‡½æ•°ï¼Œå¯ç”¨  dotNet.wait ç­‰å¾…ä»»åŠ¡å®Œæˆå¹¶è·å–è°ƒç”¨ç»“æœï¼Œç¤ºä¾‹ï¼š

```aardio
//è°ƒç”¨å¼‚æ­¥æ–¹æ³•
var task = uwp.LaunchUriAsync("ms-screenclip:")

//åŒæ­¥ç­‰å¾…ä»»åŠ¡å®Œæˆï¼Œä¸ä¼šé˜»å¡ç•Œé¢
var result = dotNet.wait(task);

```

ç›¸å…³èŒƒä¾‹ï¼š [è°ƒç”¨ UWP æ¥å£](../../../example/Languages/dotNet/Advanced/uwpCompiler.html) [.NET å¼‚æ­¥ä»»åŠ¡](../../../example/Languages/dotNet/Task.html)
